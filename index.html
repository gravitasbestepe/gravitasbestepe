<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>GravInAir - Air Quality & Emission Monitor</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
<style>
:root {
    --bg: #fafafa;
    --card: #fff;
    --muted: #666;
    --primary: #00A896;
    --secondary: #028090;
    --accent: #02C39A;
    --border: #ddd;
}
body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    margin: 0;
    background: linear-gradient(135deg, #f5f7fa 0%, #e4efe9 100%);
    color: #222;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
}
header {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px 16px;
    background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    flex-wrap: wrap;
}
header h1 {
    font-size: 20px;
    margin: 0;
    font-weight: 700;
    color: white;
    text-shadow: 0 2px 4px rgba(0,0,0,0.2);
}
.logo {
    font-weight: 800;
    background: linear-gradient(45deg, #FFD166, #06D6A0);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}
nav {
    display: flex;
    gap: 8px;
    align-items: center;
    flex-wrap: wrap;
}
nav button {
    background: transparent;
    border: 0;
    padding: 8px 12px;
    border-radius: 6px;
    cursor: pointer;
    color: white;
    transition: all 0.3s ease;
    font-weight: 500;
}
nav button:hover {
    background: rgba(255,255,255,.15);
    transform: translateY(-1px);
}
nav button.active {
    background: rgba(255,255,255,.9);
    color: var(--secondary);
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}
.lang-select {
    margin-left: auto;
    display: flex;
    gap: 8px;
    align-items: center;
}
.lang-btn {
    padding: 6px 8px;
    border-radius: 6px;
    border: 1px solid rgba(255,255,255,.3);
    background: transparent;
    cursor: pointer;
    color: white;
    transition: all 0.3s ease;
    font-size: 12px;
    font-weight: 500;
}
.lang-btn:hover {
    background: rgba(255,255,255,.1);
    transform: translateY(-1px);
}
.lang-btn.active {
    background: white;
    color: var(--secondary);
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
}
main {
    padding: 16px;
    flex: 1;
}
.grid {
    display: grid;
    grid-template-columns: 1fr 360px;
    gap: 16px;
}
.card {
    background: var(--card);
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.08);
    border: 1px solid var(--border);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}
.card:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 25px rgba(0,0,0,0.12);
}
#map, #globalMap, #nationalMap, #aqiMap {
    height: 420px;
    border-radius: 10px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}
#aqiControls {
    display: flex;
    gap: 8px;
    align-items: center;
    flex-wrap: wrap;
    padding: 12px 0;
    border-bottom: 1px solid #eee;
    margin-bottom: 12px;
}
#addressWrapper {
    flex: 1;
    position: relative;
    min-width: 200px;
}
#aqiAddressInput {
    width: 100%;
    padding: 10px 42px 10px 14px;
    font-size: 14px;
    border: 1px solid #ccc;
    border-radius: 8px;
    height: 44px;
    box-sizing: border-box;
    transition: all 0.3s ease;
    border: 1px solid #ddd;
}
#aqiAddressInput:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(0,168,150,0.1);
}
#aqiClearBtn {
    position: absolute;
    right: 4px;
    top: 50%;
    transform: translateY(-50%);
    padding: 6px 10px;
    font-size: 12px;
    border-radius: 6px;
    border: 1px solid #bbb;
    background: white;
    cursor: pointer;
    transition: all 0.3s ease;
}
#aqiClearBtn:hover {
    background: #f5f5f5;
    transform: translateY(-50%) scale(1.05);
}
#aqiLocateBtn {
    padding: 10px 16px;
    cursor: pointer;
    border-radius: 8px;
    border: 1px solid #bbb;
    background: white;
    height: 44px;
    font-size: 14px;
    white-space: nowrap;
    transition: all 0.3s ease;
    font-weight: 500;
}
#aqiLocateBtn:hover {
    background: #f5f5f5;
    transform: translateY(-1px);
}
#aqiResultList {
    position: absolute;
    left: 0;
    right: 0;
    top: 46px;
    background: white;
    box-shadow: 0 6px 20px rgba(0,0,0,0.12);
    border-radius: 8px;
    z-index: 1000;
    max-height: 300px;
    overflow: auto;
    display: none;
    font-size: 14px;
    border: 1px solid #ddd;
}
.resultItem {
    padding: 10px 14px;
    border-bottom: 1px solid #eee;
    cursor: pointer;
    transition: background-color 0.2s;
}
.resultItem:hover {
    background: #f0f7ff;
}
.aqi-bar {
    height: 24px;
    width: 100%;
    background: #e9ecef;
    margin: 12px 0;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
}
.aqi-fill {
    height: 100%;
    width: 0%;
    background: green;
    text-align: center;
    color: white;
    font-weight: bold;
    font-size: 13px;
    line-height: 24px;
    transition: width 0.5s ease;
    text-shadow: 0 1px 2px rgba(0,0,0,0.3);
}
label {
    font-size: 14px;
    color: var(--muted);
    display: block;
    margin-bottom: 6px;
    font-weight: 500;
}
.muted {
    color: var(--muted);
    font-size: 14px;
}
.btn {
    display: inline-block;
    padding: 10px 16px;
    border-radius: 8px;
    border: 1px solid #bbb;
    background: white;
    cursor: pointer;
    font-size: 14px;
    transition: all 0.3s ease;
    font-weight: 500;
    text-decoration: none;
}
.btn:hover {
    background: #f5f5f5;
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}
.btn-primary {
    background: var(--primary);
    color: white;
    border-color: var(--primary);
}
.btn-primary:hover {
    background: var(--secondary);
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(2,128,144,0.3);
}
.btn-danger {
    background: #dc3545;
    color: white;
    border-color: #dc3545;
}
.btn-danger:hover {
    background: #c82333;
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(220,53,69,0.3);
}
.pollutant-list {
    margin: 12px 0;
    padding-left: 0;
    font-size: 14px;
    list-style-type: none;
}
.pollutant-list li {
    margin-bottom: 6px;
    padding: 6px 0;
    border-bottom: 1px solid #f0f0f0;
}
.health-warning {
    background: #fff3cd;
    border: 1px solid #ffeaa7;
    border-radius: 8px;
    padding: 12px;
    margin: 12px 0;
    font-size: 13px;
}
.health-warning.high {
    background: #f8d7da;
    border: 1px solid #f5c6cb;
    color: #721c24;
}
.health-warning.medium {
    background: #fff3cd;
    border: 1px solid #ffeaa7;
    color: #856404;
}
.health-warning.low {
    background: #d1ecf1;
    border: 1px solid #bee5eb;
    color: #0c5460;
}
.health-warning h5 {
    margin: 0 0 8px 0;
    font-size: 14px;
    font-weight: 600;
}
.input-field {
    width: 100%;
    padding: 12px;
    margin: 8px 0 16px 0;
    border-radius: 8px;
    border: 1px solid #ddd;
    font-size: 14px;
    box-sizing: border-box;
    transition: all 0.3s ease;
}
.input-field:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(0,168,150,0.1);
}
.vehicle-card {
    border: 1px solid #eee;
    padding: 16px;
    border-radius: 10px;
    margin-bottom: 16px;
    background: #fafafa;
    transition: all 0.3s ease;
    position: relative;
}
.vehicle-card:hover {
    background: #f5f5f5;
    transform: translateY(-2px);
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}
.status-allowed {
    color: #28a745;
    font-weight: bold;
}
.status-limited {
    color: #ffc107;
    font-weight: bold;
}
.status-banned {
    color: #dc3545;
    font-weight: bold;
}
.vehicle-advice {
    background: #fff3cd;
    border: 1px solid #ffeaa7;
    border-radius: 6px;
    padding: 10px;
    margin-top: 10px;
    font-size: 13px;
    color: #856404;
}
.vehicle-advice h5 {
    margin: 0 0 5px 0;
    font-size: 13px;
    color: #856404;
}
.vehicle-actions {
    display: flex;
    gap: 8px;
    margin-top: 12px;
    flex-wrap: wrap;
}
.color-preview {
    width: 20px;
    height: 20px;
    border-radius: 4px;
    display: inline-block;
    margin-right: 8px;
    border: 1px solid #ddd;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
.loading {
    color: var(--muted);
    font-style: italic;
}
.quick-actions {
    display: flex;
    gap: 12px;
    margin: 16px 0;
    flex-wrap: wrap;
}
.country-aqi-item {
    padding: 8px 10px;
    border-bottom: 1px solid #eee;
    font-size: 13px;
    transition: background-color 0.2s;
}
.country-aqi-item:hover {
    background: #f8f9fa;
}
.country-aqi-item:last-child {
    border-bottom: none;
}
.aqi-value {
    font-weight: bold;
    float: right;
}
footer {
    background: linear-gradient(135deg, var(--secondary) 0%, var(--primary) 100%);
    color: white;
    text-align: center;
    padding: 20px;
    margin-top: auto;
}
.footer-content {
    max-width: 1200px;
    margin: 0 auto;
}
.copyright {
    font-size: 14px;
    opacity: 0.9;
    font-weight: 500;
}

/* Resources page styles */
.resources-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 16px;
    margin-top: 16px;
}
.resource-card {
    background: var(--card);
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.08);
    border: 1px solid var(--border);
    transition: all 0.3s ease;
    height: 100%;
    display: flex;
    flex-direction: column;
}
.resource-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 25px rgba(0,0,0,0.12);
}
.resource-category {
    font-size: 18px;
    font-weight: 600;
    margin-bottom: 16px;
    color: var(--primary);
    border-bottom: 2px solid var(--accent);
    padding-bottom: 8px;
}
.resource-list {
    list-style: none;
    padding: 0;
    margin: 0;
    flex: 1;
}
.resource-item {
    margin-bottom: 12px;
    padding-bottom: 12px;
    border-bottom: 1px solid #f0f0f0;
}
.resource-item:last-child {
    margin-bottom: 0;
    padding-bottom: 0;
    border-bottom: none;
}
.resource-link {
    color: var(--secondary);
    text-decoration: none;
    font-weight: 500;
    transition: color 0.3s ease;
    display: block;
    margin-bottom: 4px;
}
.resource-link:hover {
    color: var(--primary);
    text-decoration: underline;
}
.resource-description {
    font-size: 13px;
    color: var(--muted);
    line-height: 1.4;
}

@media (max-width: 900px) {
    .grid {
        grid-template-columns: 1fr;
    }
    #map, #globalMap, #nationalMap, #aqiMap {
        height: 300px;
    }
    header {
        flex-direction: column;
        align-items: flex-start;
    }
    .lang-select {
        margin-left: 0;
        margin-top: 8px;
    }
    .quick-actions {
        flex-direction: column;
    }
    .vehicle-actions {
        flex-direction: column;
    }
    .resources-grid {
        grid-template-columns: 1fr;
    }
}
</style>
</head>
<body>
<header>
    <h1><span class="logo">GravInAir</span> - Air Quality & Emission Monitor</h1>
    <nav>
        <button id="nav-home" class="active">Home</button>
        <button id="nav-register">Device Register</button>
        <button id="nav-vehicle">My Vehicles</button>
        <button id="nav-rules">Rules & Advice</button>
        <button id="nav-global">Global Emission Map</button>
        <button id="nav-aqi">Detailed AQI Map</button>
        <button id="nav-resources">Resources</button>
    </nav>
    <div class="lang-select">
        <button class="lang-btn active" data-lang="en" id="lang-en">EN</button>
        <button class="lang-btn" data-lang="tr" id="lang-tr">TR</button>
        <button class="lang-btn" data-lang="de" id="lang-de">DE</button>
        <button class="lang-btn" data-lang="ru" id="lang-ru">RU</button>
    </div>
</header>
<main>
    <section id="page-home">
        <div class="grid">
            <div class="card">
                <h2 id="home-title">Quick Vehicle Emission Simulator</h2>
                <p class="muted" id="home-desc">Register your device and get simulated emission readings here.</p>
                
                <div class="quick-actions">
                    <button class="btn btn-primary" onclick="quickReadAll()" id="quickReadBtn">
                        Read All Devices
                    </button>
                    <button class="btn" onclick="quickSimulateAll()" id="quickSimulateBtn">
                        Simulate All Trips
                    </button>
                </div>

                <div style="margin-top: 16px">
                    <h3 id="lastReadLabel">Last Reading</h3>
                    <div id="lastRead" class="muted">No readings yet.</div>
                    
                    <h3 style="margin-top: 16px;" id="vehicleStatusLabel">Vehicle Status</h3>
                    <div id="vehicleStatus" class="muted">No vehicles registered.</div>
                    
                    <hr/>
                    <h3 id="behaviourLabel">System Behaviour</h3>
                    <p class="muted" id="behaviourText">This demo simulates device readings and traffic eligibility.</p>
                </div>
            </div>
            <aside class="card">
                <h3 id="quickRegisterTitle">Device Registration</h3>
                <p class="muted" id="quickRegisterDesc">Use the Device Register tab to manage vehicles.</p>
                <button class="btn btn-primary" onclick="show('register')" style="margin-top: 12px; width: 100%">
                    Go to Registration
                </button>

                <div style="margin-top: 20px;">
                    <h3 id="globalAqiTitle">Country AQI Averages</h3>
                    <div id="countryAqiList" class="muted">
                        <div class="loading">Loading country data...</div>
                    </div>
                </div>
            </aside>
        </div>
    </section>

    <section id="page-register" style="display:none">
        <div class="card">
            <h2 id="regTitle">Device Register</h2>
            <label id="reg_plate_label">License Plate</label>
            <input id="reg_plate" class="input-field" placeholder="e.g., 34ABC123"/>
            
            <label id="reg_device_label">Device ID</label>
            <input id="reg_device" class="input-field" placeholder="e.g., DEV001"/>
            
            <label id="reg_city_label">City</label>
            <input id="reg_city" class="input-field" placeholder="e.g., Istanbul"/>
            
            <label id="reg_make_label">Brand</label>
            <input id="reg_make" class="input-field" placeholder="e.g., Toyota"/>
            
            <label id="reg_model_label">Vehicle Model</label>
            <input id="reg_model" class="input-field" placeholder="e.g., Corolla"/>
            
            <label id="reg_engine_label">Engine Number</label>
            <input id="reg_engine" class="input-field" placeholder="e.g., ENG123456"/>
            
            <label id="reg_color_label">Vehicle Color</label>
            <input id="reg_color" class="input-field" placeholder="e.g., Red, Blue, Black" list="colorOptions"/>
            <datalist id="colorOptions">
                <option value="Red">
                <option value="Blue">
                <option value="Black">
                <option value="White">
                <option value="Silver">
                <option value="Gray">
                <option value="Green">
                <option value="Yellow">
                <option value="Orange">
                <option value="Purple">
            </datalist>
            
            <button id="regBtn" class="btn btn-primary" style="width: 100%; margin-top: 8px">
                Create Registration
            </button>
            
            <hr/>
            <h3 id="registeredTitle">Registered Devices</h3>
            <div id="registeredList"></div>
        </div>
    </section>

    <section id="page-vehicle" style="display:none">
        <div class="card">
            <h2 id="myVehiclesTitle">My Vehicles</h2>
            <div id="myVehicles"></div>
        </div>
    </section>

    <section id="page-rules" style="display:none">
        <div class="card">
            <h2 id="rulesTitle">Rules & Advice</h2>
            <ul>
                <li id="rule1">PM2.5 > 150 => Traffic ban recommended.</li>
                <li id="rule2">PM2.5 100-150 => Limited (restricted times).</li>
                <li id="rule3">PM2.5 <= 100 => Normal traffic permitted.</li>
            </ul>
            <h3 id="adviceTitle">Advice</h3>
            <ol>
                <li id="advice1">Check filters and catalytic converter.</li>
                <li id="advice2">Routine maintenance.</li>
                <li id="advice3">Reduce idling.</li>
            </ol>
        </div>
    </section>

    <section id="page-global" style="display:none">
        <div class="card">
            <h2 id="globalTitle">Global Emission Map</h2>
            <p class="muted" id="globalDesc">Showing country average AQI values and high pollution areas.</p>
            <div id="globalMap"></div>
            <div id="globalSummary" style="margin-top: 12px" class="muted"></div>
            <div id="globalLoading" class="loading" style="display: none;">Loading country AQI data...</div>
        </div>
    </section>

    <section id="page-aqi" style="display:none">
        <div class="grid">
            <div class="card">
                <h2 id="aqiMapTitle">Interactive Air Quality Map</h2>
                <div id="aqiControls">
                    <div id="addressWrapper">
                        <input id="aqiAddressInput" placeholder="Enter detailed address (street, city, country)" autocomplete="off"/>
                        <button id="aqiClearBtn">Clear</button>
                        <div id="aqiResultList"></div>
                    </div>
                    <button id="aqiLocateBtn">Locate Me</button>
                </div>
                <div id="aqiMap"></div>
            </div>
            <aside class="card" id="aqiDetailsCard">
                <h3 id="aqiDetailTitle">Air Quality Details</h3>
                <h4 id="aqiLocationLabel">Location: —</h4>
                <div class="aqi-bar"><div id="detailAqiBar" class="aqi-fill">—</div></div>
                <p id="detailAqiText" style="margin-bottom: 8px;">AQI: —</p>
                <p id="detailDominantPollutant">Dominant Pollutant: —</p>
                <hr/>
                <h4 id="pollutantTitle">Pollutant Details (µg/m³)</h4>
                <ul id="pollutantsList" class="pollutant-list">
                    <li class="muted" id="pollutantsPlaceholder">Click on the map or search for a location.</li>
                </ul>
                <hr/>
                <div id="healthWarnings"></div>
                <p id="detailWarningMsg" style="color:#b22222; font-weight:bold; font-size:14px; margin-top: 12px;"></p>
                <p id="detailMaskMsg" style="color:#0000aa; font-weight:bold; font-size:14px;"></p>
            </aside>
        </div>
    </section>

    <!-- NEW RESOURCES PAGE -->
    <section id="page-resources" style="display:none">
        <div class="card">
            <h2 id="resourcesTitle">Resources & References</h2>
            <p class="muted" id="resourcesDesc">External data sources, APIs, and references used in this application.</p>
            
            <div class="resources-grid">
                <div class="resource-card">
                    <div class="resource-category">Mapping & Geocoding</div>
                    <ul class="resource-list">
                        <li class="resource-item">
                            <a href="https://nominatim.openstreetmap.org" class="resource-link" target="_blank">Nominatim OpenStreetMap</a>
                            <div class="resource-description">Open-source geocoding service for address search and reverse geocoding</div>
                        </li>
                        <li class="resource-item">
                            <a href="https://www.openstreetmap.org/#map=6/39.03/35.25" class="resource-link" target="_blank">OpenStreetMap</a>
                            <div class="resource-description">Collaborative mapping project providing free geographic data</div>
                        </li>
                        <li class="resource-item">
                            <a href="https://unpkg.com/leaflet" class="resource-link" target="_blank">Leaflet Library</a>
                            <div class="resource-description">JavaScript library for interactive maps</div>
                        </li>
                        <li class="resource-item">
                            <a href="https://www.geolocation.com/" class="resource-link" target="_blank">Geolocation API</a>
                            <div class="resource-description">IP address geolocation service</div>
                        </li>
                    </ul>
                </div>
                
                <div class="resource-card">
                    <div class="resource-category">Air Quality Data</div>
                    <ul class="resource-list">
                        <li class="resource-item">
                            <a href="https://aqicn.org/map/world" class="resource-link" target="_blank">World Air Quality Index</a>
                            <div class="resource-description">Real-time air quality index visual map with global coverage</div>
                        </li>
                        <li class="resource-item">
                            <a href="https://aqicn.org/faq/2015-02-15/satellite-air-quality-monitoring-introduction-to-the-nasa-worldview/tr/" class="resource-link" target="_blank">NASA WorldView</a>
                            <div class="resource-description">Satellite air quality monitoring introduction</div>
                        </li>
                        <li class="resource-item">
                            <a href="https://www.airnow.gov/?city=Albuquerque&state=NM&country=TR" class="resource-link" target="_blank">AirNow Ground Stations</a>
                            <div class="resource-description">Ground station networks observation data</div>
                        </li>
                        <li class="resource-item">
                            <a href="https://opendap.earthdata.nasa.gov/" class="resource-link" target="_blank">NASA Hyrax Data</a>
                            <div class="resource-description">Direct access to subsetting of NASA data using Python</div>
                        </li>
                    </ul>
                </div>
                
                <div class="resource-card">
                    <div class="resource-category">Research & Health</div>
                    <ul class="resource-list">
                        <li class="resource-item">
                            <a href="https://www.tandfonline.com/doi/abs/10.1080/10643380701413377" class="resource-link" target="_blank">Vehicle Emissions Monitoring</a>
                            <div class="resource-description">Review and critical discussion of real-world vehicle exhaust emissions</div>
                        </li>
                        <li class="resource-item">
                            <a href="https://www.sciencedirect.com/science/article/abs/pii/S030438941400315X" class="resource-link" target="_blank">Non-Exhaust Emissions</a>
                            <div class="resource-description">Urban air quality and the challenge of traffic non-exhaust emissions</div>
                        </li>
                        <li class="resource-item">
                            <a href="https://publications.ersnet.org/content/erj/17/4/733.abstract" class="resource-link" target="_blank">Diesel Exhaust Health Effects</a>
                            <div class="resource-description">Research on health effects of diesel exhaust emissions</div>
                        </li>
                        <li class="resource-item">
                            <a href="https://www.who.int/health-topics/air-pollution#tab=tab_1" class="resource-link" target="_blank">WHO Air Pollution</a>
                            <div class="resource-description">World Health Organization air pollution information and guidelines</div>
                        </li>
                    </ul>
                </div>
                
                <div class="resource-card">
                    <div class="resource-category">Development & Tools</div>
                    <ul class="resource-list">
                        <li class="resource-item">
                            <a href="https://visualstudio.microsoft.com/" class="resource-link" target="_blank">Visual Studio</a>
                            <div class="resource-description">Integrated development environment</div>
                        </li>
                        <li class="resource-item">
                            <a href="https://www.w3schools.com/html/html_computercode_elements.asp" class="resource-link" target="_blank">W3Schools HTML</a>
                            <div class="resource-description">HTML computer code elements reference</div>
                        </li>
                        <li class="resource-item">
                            <a href="https://chatgpt.com/" class="resource-link" target="_blank">ChatGPT</a>
                            <div class="resource-description">AI assistant for development support</div>
                        </li>
                        <li class="resource-item">
                            <a href="https://github.com/gravitasbestepe/gravitasbestepe" class="resource-link" target="_blank">GitHub Repository</a>
                            <div class="resource-description">Project source code repository</div>
                        </li>
                    </ul>
                </div>
                
                <div class="resource-card">
                    <div class="resource-category">Hosting & Deployment</div>
                    <ul class="resource-list">
                        <li class="resource-item">
                            <a href="https://www.godaddy.com/" class="resource-link" target="_blank">GoDaddy</a>
                            <div class="resource-description">Domain name registration and web hosting</div>
                        </li>
                        <li class="resource-item">
                            <a href="https://vercel.com/" class="resource-link" target="_blank">Vercel</a>
                            <div class="resource-description">Cloud platform for static sites and serverless functions</div>
                        </li>
                    </ul>
                </div>
                
                <div class="resource-card">
                    <div class="resource-category">Educational Content</div>
                    <ul class="resource-list">
                        <li class="resource-item">
                            <a href="https://www.youtube.com/watch?v=FsR2iylJlLE" class="resource-link" target="_blank">60 Second Science: Air Quality</a>
                            <div class="resource-description">Educational video on air quality concepts</div>
                        </li>
                        <li class="resource-item">
                            <a href="https://appliedsciences.nasa.gov/get-involved/training/english/arset-inside-look-how-nasa-measures-air-pollution" class="resource-link" target="_blank">NASA ARSET Training</a>
                            <div class="resource-description">Inside look at how NASA measures air pollution</div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </section>
</main>

<footer>
    <div class="footer-content">
        <div class="copyright">© 2025 GravInAir - All rights reserved</div>
    </div>
</footer>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
const WAQI_TOKEN = "9263e25a74b0d93c30387fa753ec876f19869d38";
const NOMINATIM_BASE = "https://nominatim.openstreetmap.org";

const translations = {
    en: {
        title: "GravInAir - Air Quality & Emission Monitor",
        nav: { home:"Home", register:"Device Register", vehicle:"My Vehicles", rules:"Rules & Advice", global:"Global Emission Map", aqi: "Detailed AQI Map", resources: "Resources" },
        homeTitle: "Quick Vehicle Emission Simulator",
        homeDesc: "Register your device and get simulated emission readings here.",
        lastReadLabel: "Last Reading", 
        behaviourLabel: "System Behaviour",
        vehicleStatusLabel: "Vehicle Status",
        behaviourText: "This demo simulates device readings and traffic eligibility.",
        quickRegisterTitle: "Device Registration",
        quickRegisterDesc: "Use the Device Register tab to manage vehicles.",
        regTitle: "Device Register", 
        registeredTitle: "Registered Devices", 
        myVehiclesTitle: "My Vehicles", 
        rulesTitle: "Rules & Advice", 
        globalTitle: "Global Emission Map", 
        globalDesc: "Showing country average AQI values and high pollution areas.",
        resourcesTitle: "Resources & References",
        resourcesDesc: "External data sources, APIs, and references used in this application.",
        reg_plate_label: "License Plate", 
        reg_device_label: "Device ID", 
        reg_city_label: "City", 
        reg_make_label: "Brand", 
        reg_model_label: "Vehicle Model", 
        reg_engine_label: "Engine Number", 
        reg_color_label: "Vehicle Color",
        regBtn: "Create Registration", 
        registerSuccess: "Registration created successfully!",
        quickReadBtn: "Read All Devices",
        quickSimulateBtn: "Simulate All Trips",
        aqiMapTitle: "Interactive Air Quality Map", 
        aqiDetailTitle: "Air Quality Details",
        globalAqiTitle: "Country AQI Averages",
        aqiLocation: "Location", 
        aqiText: "AQI", 
        aqiPollutant: "Dominant Pollutant", 
        locateBtn: "Locate Me", 
        aqiClear: "Clear", 
        searchPlaceholder: "Enter detailed address (street, city, country)",
        pollutantTitle: "Pollutant Details (µg/m³)",
        pollutantPlaceholder: "Click on the map or search for a location.",
        aqiNoData: "AQI data not available for this location.",
        aqiWarning_good: "✅ Air quality is good for everyone.", 
        aqiWarning_moderate: "⚠️ Moderate. Sensitive people should take care.", 
        aqiWarning_usg: "⚠️ Unhealthy for sensitive groups. Limit outdoor activity.", 
        aqiWarning_unhealthy: "❌ Unhealthy. Avoid outdoor exercise.", 
        aqiWarning_v_unhealthy: "☠️ Very unhealthy. Everyone should stay indoors.", 
        aqiWarning_hazardous: "🚫 Hazardous. Stay indoors.",
        aqiMask_usg: "Consider wearing a mask if you have respiratory conditions.", 
        aqiMask_unhealthy: "Wear a mask if going outside.", 
        aqiMask_v_unhealthy: "Use a high-quality mask if you must go out.", 
        aqiMask_hazardous: "Wear a mask and use air purifier.",
        noDevices: "No devices registered.",
        noVehicles: "No vehicles registered.",
        trafficAllowed: "TRAFFIC ALLOWED",
        trafficLimited: "LIMITED (RESTRICTED TIMES)",
        trafficBanned: "TRAFFIC NOT ALLOWED",
        rule1: "PM2.5 > 150 => Traffic ban recommended.",
        rule2: "PM2.5 100-150 => Limited (restricted times).",
        rule3: "PM2.5 <= 100 => Normal traffic permitted.",
        advice1: "Check filters and catalytic converter.",
        advice2: "Routine maintenance.",
        advice3: "Reduce idling.",
        loading: "Loading data...",
        noHighPollution: "No high pollution areas found.",
        simulationDuration: "Simulation duration: 24 seconds",
        manualRead: "Manual Read",
        simulateTrip: "Simulate Trip",
        readingAll: "Reading all devices...",
        simulatingAll: "Simulating all trips...",
        deleteVehicle: "Delete",
        vehicleAdviceTitle: "Recommendations:",
        vehicleAdviceGood: "✅ Your vehicle emissions are within acceptable limits.",
        vehicleAdviceModerate: "⚠️ Consider regular maintenance and filter checks.",
        vehicleAdvicePoor: "❌ High emissions detected. Recommended actions:",
        vehicleAdviceList1: "• Check and replace air filters",
        vehicleAdviceList2: "• Inspect catalytic converter",
        vehicleAdviceList3: "• Schedule engine maintenance",
        vehicleAdviceList4: "• Avoid unnecessary idling",
        vehicleAdviceList5: "• Consider professional emission test",
        deleteConfirm: "Are you sure you want to delete this vehicle?",
        healthWarningTitle: "⚠️ Health Advisory for Respiratory Conditions",
        healthWarningGood: "✅ Safe for people with asthma, COPD, and bronchitis",
        healthWarningModerate: "⚠️ People with respiratory conditions should:",
        healthWarningModerate1: "• Limit prolonged outdoor exertion",
        healthWarningModerate2: "• Keep medications handy",
        healthWarningModerate3: "• Monitor symptoms closely",
        healthWarningHigh: "🚫 HIGH RISK for people with:",
        healthWarningHigh1: "• Asthma",
        healthWarningHigh2: "• COPD (Chronic Bronchitis/Emphysem)",
        healthWarningHigh3: "• Bronchitis",
        healthWarningHigh4: "• Other respiratory diseases",
        healthWarningActions: "Recommended actions:",
        healthWarningAction1: "• Stay indoors with windows closed",
        healthWarningAction2: "• Use air purifiers",
        healthWarningAction3: "• Avoid physical exertion",
        healthWarningAction4: "• Keep rescue medications available",
        healthWarningAction5: "• Consult doctor if symptoms worsen"
    },
    tr: {
        title: "GravInAir - Hava Kalitesi & Emisyon İzleyici",
        nav: { home:"Anasayfa", register:"Cihaz Kayıt", vehicle:"Araçlarım", rules:"Kurallar & Öneriler", global:"Global Emisyon Haritası", aqi: "Detaylı HKİ Haritası", resources: "Kaynaklar" },
        homeTitle: "Hızlı Araç Emisyon Simülatörü",
        homeDesc: "Cihazınızı kaydedin ve simüle emisyon okumaları alın.",
        lastReadLabel: "Son Okuma", 
        behaviourLabel: "Sistem Davranışı",
        vehicleStatusLabel: "Araç Durumu",
        behaviourText: "Bu demo, cihaz okumalarını ve trafik uygunluğunu simüle eder.",
        quickRegisterTitle: "Cihaz Kayıt",
        quickRegisterDesc: "Araçları yönetmek için Cihaz Kayıt sekmesini kullanın.",
        regTitle: "Cihaz Kayıt", 
        registeredTitle: "Kayıtlı Cihazlar", 
        myVehiclesTitle: "Araçlarım", 
        rulesTitle: "Kurallar & Öneriler", 
        globalTitle: "Global Emisyon Haritası", 
        globalDesc: "Ülke ortalama HKİ değerleri ve yüksek kirlilik bölgeleri gösteriliyor.",
        resourcesTitle: "Kaynaklar & Referanslar",
        resourcesDesc: "Bu uygulamada kullanılan harici veri kaynakları, API'ler ve referanslar.",
        reg_plate_label: "Plaka", 
        reg_device_label: "Cihaz ID", 
        reg_city_label: "Şehir", 
        reg_make_label: "Marka", 
        reg_model_label: "Araç Modeli", 
        reg_engine_label: "Motor Numarası", 
        reg_color_label: "Araç Rengi",
        regBtn: "Kayıt Oluştur", 
        registerSuccess: "Kayıt başarıyla oluşturuldu!",
        quickReadBtn: "Tüm Cihazları Oku",
        quickSimulateBtn: "Tüm Yolculukları Simüle Et",
        aqiMapTitle: "Etkileşimli Hava Kalitesi Haritası", 
        aqiDetailTitle: "Hava Kalitesi Detayları",
        globalAqiTitle: "Ülke HKİ Ortalamaları",
        aqiLocation: "Konum", 
        aqiText: "HKİ", 
        aqiPollutant: "Baskın Kirletici", 
        locateBtn: "Konumumu Bul", 
        aqiClear: "Temizle", 
        searchPlaceholder: "Detaylı adres girin (sokak, şehir, ülke)",
        pollutantTitle: "Kirletici Detayları (µg/m³)",
        pollutantPlaceholder: "Haritaya tıklayın veya bir konum arayın.",
        aqiNoData: "Bu konum için HKİ verisi mevcut değil.",
        aqiWarning_good: "✅ Hava kalitesi herkes için iyi.", 
        aqiWarning_moderate: "⚠️ Orta. Hassas kişilerin dikkatli olması gerekir.", 
        aqiWarning_usg: "⚠️ Hassas gruplar için sağlıksız. Dışarıdaki aktiviteleri sınırlayın.", 
        aqiWarning_unhealthy: "❌ Sağlıksız. Dışarıda egzersiz yapmaktan kaçının.", 
        aqiWarning_v_unhealthy: "☠️ Çok sağlıksız. Herkes içeride kalmalı.", 
        aqiWarning_hazardous: "🚫 Tehlikeli. İçeride kalın.",
        aqiMask_usg: "Solunum rahatsızlığınız varsa maske takmayı düşünün.", 
        aqiMask_unhealthy: "Dışarı çıkacaksanız maske takın.", 
        aqiMask_v_unhealthy: "Dışarı çıkmanız gerekiyorsa yüksek kaliteli maske kullanın.", 
        aqiMask_hazardous: "Maske takın ve hava temizleyici kullanın.",
        noDevices: "Kayıtlı cihaz bulunmamaktadır.",
        noVehicles: "Kayıtlı araç bulunmamaktadır.",
        trafficAllowed: "TRAFİĞE UYGUN",
        trafficLimited: "KISITLI (KISITLI SAATLER)",
        trafficBanned: "TRAFİĞE UYGUN DEĞİL",
        rule1: "PM2.5 > 150 => Trafik yasağı önerilir.",
        rule2: "PM2.5 100-150 => Kısıtlı (sınırlı saatler).",
        rule3: "PM2.5 <= 100 => Normal trafiğe izin verilir.",
        advice1: "Filtreleri ve katalitik konvertörü kontrol edin.",
        advice2: "Düzenli bakım.",
        advice3: "Rölantide çalışmayı azaltın.",
        loading: "Veriler yükleniyor...",
        noHighPollution: "Yüksek kirlilik bölgesi bulunamadı.",
        simulationDuration: "Simülasyon süresi: 24 saniye",
        manualRead: "Manuel Okuma",
        simulateTrip: "Yolculuk Simüle Et",
        readingAll: "Tüm cihazlar okunuyor...",
        simulatingAll: "Tüm yolculuklar simüle ediliyor...",
        deleteVehicle: "Sil",
        vehicleAdviceTitle: "Öneriler:",
        vehicleAdviceGood: "✅ Aracınızın emisyonları kabul edilebilir sınırlar içinde.",
        vehicleAdviceModerate: "⚠️ Düzenli bakım ve filtre kontrolleri yapmayı düşünün.",
        vehicleAdvicePoor: "❌ Yüksek emisyon tespit edildi. Önerilen eylemler:",
        vehicleAdviceList1: "• Hava filtrelerini kontrol edin ve değiştirin",
        vehicleAdviceList2: "• Katalitik konvertörü kontrol edin",
        vehicleAdviceList3: "• Motor bakımı planlayın",
        vehicleAdviceList4: "• Gereksiz rölantiden kaçının",
        vehicleAdviceList5: "• Profesyonel emisyon testi düşünün",
        deleteConfirm: "Bu aracı silmek istediğinizden emin misiniz?",
        healthWarningTitle: "⚠️ Solunum Hastalıkları İçin Sağlık Uyarısı",
        healthWarningGood: "✅ Astım, KOAH ve bronşit hastaları için güvenli",
        healthWarningModerate: "⚠️ Solunum rahatsızlığı olan kişiler:",
        healthWarningModerate1: "• Uzun süreli dış mekan aktivitelerini sınırlayın",
        healthWarningModerate2: "• İlaçlarınızı yanınızda bulundurun",
        healthWarningModerate3: "• Belirtilerinizi yakından takip edin",
        healthWarningHigh: "🚫 YÜKSEK RİSK altındaki kişiler:",
        healthWarningHigh1: "• Astım",
        healthWarningHigh2: "• KOAH (Kronik Bronşit/Amfizem)",
        healthWarningHigh3: "• Bronşit",
        healthWarningHigh4: "• Diğer solunum hastalıkları",
        healthWarningActions: "Önerilen eylemler:",
        healthWarningAction1: "• Pencereler kapalı şekilde içeride kalın",
        healthWarningAction2: "• Hava temizleyici kullanın",
        healthWarningAction3: "• Fiziksel efordan kaçının",
        healthWarningAction4: "• Acil ilaçlarınızı hazır bulundurun",
        healthWarningAction5: "• Belirtiler kötüleşirse doktora başvurun"
    },
    de: {
        title: "GravInAir - Luftqualitäts- & Emissionsmonitor",
        nav: { home:"Startseite", register:"Geräteregistrierung", vehicle:"Meine Fahrzeuge", rules:"Regeln & Ratschläge", global:"Globale Emissionskarte", aqi: "Detaillierte AQI-Karte", resources: "Ressourcen" },
        homeTitle: "Schneller Fahrzeugemissionssimulator",
        homeDesc: "Registrieren Sie Ihr Gerät und erhalten Sie simulierte Emissionsmesswerte.",
        lastReadLabel: "Letzte Messung", 
        behaviourLabel: "Systemverhalten",
        vehicleStatusLabel: "Fahrzeugstatus",
        behaviourText: "Diese Demo simuliert Gerätemesswerte und Verkehrszulassung.",
        quickRegisterTitle: "Geräteregistrierung",
        quickRegisterDesc: "Verwenden Sie den Geräteregistrierungs-Tab, um Fahrzeuge zu verwalten.",
        regTitle: "Geräteregistrierung", 
        registeredTitle: "Registrierte Geräte", 
        myVehiclesTitle: "Meine Fahrzeuge", 
        rulesTitle: "Regeln & Ratschläge", 
        globalTitle: "Globale Emissionskarte", 
        globalDesc: "Zeigt durchschnittliche AQI-Werte pro Land und hochbelastete Gebiete.",
        resourcesTitle: "Ressourcen & Referenzen",
        resourcesDesc: "Externe Datenquellen, APIs und Referenzen, die in dieser Anwendung verwendet werden.",
        reg_plate_label: "Nummernschild", 
        reg_device_label: "Geräte-ID", 
        reg_city_label: "Stadt", 
        reg_make_label: "Marke", 
        reg_model_label: "Fahrzeugmodell", 
        reg_engine_label: "Motornummer", 
        reg_color_label: "Fahrzeugfarbe",
        regBtn: "Registrierung erstellen", 
        registerSuccess: "Registrierung erfolgreich erstellt!",
        quickReadBtn: "Alle Geräte auslesen",
        quickSimulateBtn: "Alle Fahrten simulieren",
        aqiMapTitle: "Interaktive Luftqualitätskarte", 
        aqiDetailTitle: "Luftqualitätsdetails",
        globalAqiTitle: "Durchschnittliche AQI-Werte pro Land",
        aqiLocation: "Standort", 
        aqiText: "AQI", 
        aqiPollutant: "Dominantes Schadstoff", 
        locateBtn: "Meinen Standort", 
        aqiClear: "Löschen", 
        searchPlaceholder: "Detaillierte Adresse eingeben (Straße, Stadt, Land)",
        pollutantTitle: "Schadstoffdetails (µg/m³)",
        pollutantPlaceholder: "Klicken Sie auf die Karte oder suchen Sie nach einem Standort.",
        aqiNoData: "AQI-Daten für diesen Standort nicht verfügbar.",
        aqiWarning_good: "✅ Luftqualität ist gut für alle.", 
        aqiWarning_moderate: "⚠️ Mäßig. Empfindliche Personen sollten vorsichtig sein.", 
        aqiWarning_usg: "⚠️ Ungesund für empfindliche Gruppen. Begrenzen Sie Aktivitäten im Freien.", 
        aqiWarning_unhealthy: "❌ Ungesund. Vermeiden Sie Bewegung im Freien.", 
        aqiWarning_v_unhealthy: "☠️ Sehr ungesund. Jeder sollte drinnen bleiben.", 
        aqiWarning_hazardous: "🚫 Gefährlich. Bleiben Sie drinnen.",
        aqiMask_usg: "Erwägen Sie eine Maske zu tragen, wenn Sie Atemwegserkrankungen haben.", 
        aqiMask_unhealthy: "Tragen Sie eine Maske, wenn Sie nach draußen gehen.", 
        aqiMask_v_unhealthy: "Verwenden Sie eine hochwertige Maske, wenn Sie raus müssen.", 
        aqiMask_hazardous: "Tragen Sie eine Maske und verwenden Sie einen Luftreiniger.",
        noDevices: "Keine Geräte registriert.",
        noVehicles: "Keine Fahrzeuge registriert.",
        trafficAllowed: "VERKEHR ERLAUBT",
        trafficLimited: "EINGESCHRÄNKT (BEGRENZTE ZEITEN)",
        trafficBanned: "VERKEHR NICHT ERLAUBT",
        rule1: "PM2.5 > 150 => Verkehrsverbot empfohlen.",
        rule2: "PM2.5 100-150 => Eingeschränkt (begrenzte Zeiten).",
        rule3: "PM2.5 <= 100 => Normaler Verkehr erlaubt.",
        advice1: "Überprüfen Sie Filter und Katalysator.",
        advice2: "Regelmäßige Wartung.",
        advice3: "Leerlaufzeiten reduzieren.",
        loading: "Daten werden geladen...",
        noHighPollution: "Keine hochbelasteten Gebiete gefunden.",
        simulationDuration: "Simulationsdauer: 24 Sekunden",
        manualRead: "Manuelles Auslesen",
        simulateTrip: "Fahrt simulieren",
        readingAll: "Alle Geräte werden ausgelesen...",
        simulatingAll: "Alle Fahrten werden simuliert...",
        deleteVehicle: "Löschen",
        vehicleAdviceTitle: "Empfehlungen:",
        vehicleAdviceGood: "✅ Ihre Fahrzeugemissionen liegen innerhalb akzeptabler Grenzen.",
        vehicleAdviceModerate: "⚠️ Erwägen Sie regelmäßige Wartung und Filterkontrollen.",
        vehicleAdvicePoor: "❌ Hohe Emissionen erkannt. Empfohlene Maßnahmen:",
        vehicleAdviceList1: "• Luftfilter überprüfen und ersetzen",
        vehicleAdviceList2: "• Katalysator überprüfen",
        vehicleAdviceList3: "• Motorwartung planen",
        vehicleAdviceList4: "• Unnötigen Leerlauf vermeiden",
        vehicleAdviceList5: "• Professionellen Emissionstest in Betracht ziehen",
        deleteConfirm: "Sind Sie sicher, dass Sie dieses Fahrzeug löschen möchten?",
        healthWarningTitle: "⚠️ Gesundheitshinweis für Atemwegserkrankungen",
        healthWarningGood: "✅ Sicher für Menschen mit Asthma, COPD und Bronchitis",
        healthWarningModerate: "⚠️ Menschen mit Atemwegserkrankungen sollten:",
        healthWarningModerate1: "• Längere körperliche Anstrengung im Freien einschränken",
        healthWarningModerate2: "• Medikamente griffbereit halten",
        healthWarningModerate3: "• Symptome genau beobachten",
        healthWarningHigh: "🚫 HOHES RISIKO für Menschen mit:",
        healthWarningHigh1: "• Asthma",
        healthWarningHigh2: "• COPD (Chronische Bronchitis/Emphysem)",
        healthWarningHigh3: "• Bronchitis",
        healthWarningHigh4: "• Anderen Atemwegserkrankungen",
        healthWarningActions: "Empfohlene Maßnahmen:",
        healthWarningAction1: "• Drinnen bleiben mit geschlossenen Fenstern",
        healthWarningAction2: "• Luftreiniger verwenden",
        healthWarningAction3: "• Körperliche Anstrengung vermeiden",
        healthWarningAction4: "• Notfallmedikamente bereithalten",
        healthWarningAction5: "• Arzt konsultieren bei verschlimmerten Symptomen"
    },
    ru: {
        title: "GravInAir - Монитор качества воздуха и выбросов",
        nav: { home:"Главная", register:"Регистрация устройств", vehicle:"Мои транспортные средства", rules:"Правила и рекомендации", global:"Глобальная карта выбросов", aqi: "Детальная карта AQI", resources: "Ресурсы" },
        homeTitle: "Быстрый симулятор выбросов транспортных средств",
        homeDesc: "Зарегистрируйте ваше устройство и получайте смоделированные показания выбросов.",
        lastReadLabel: "Последнее показание", 
        behaviourLabel: "Поведение системы",
        vehicleStatusLabel: "Статус транспортного средства",
        behaviourText: "Эта демонстрация имитирует показания устройств и допуск к движению.",
        quickRegisterTitle: "Регистрация устройств",
        quickRegisterDesc: "Используйте вкладку регистрации устройств для управления транспортными средствами.",
        regTitle: "Регистрация устройств", 
        registeredTitle: "Зарегистрированные устройства", 
        myVehiclesTitle: "Мои транспортные средства", 
        rulesTitle: "Правила и рекомендации", 
        globalTitle: "Глобальная карта выбросов", 
        globalDesc: "Показаны средние значения AQI по странам и зоны с высоким уровнем загрязнения.",
        resourcesTitle: "Ресурсы и ссылки",
        resourcesDesc: "Внешние источники данных, API и ссылки, используемые в этом приложении.",
        reg_plate_label: "Номерной знак", 
        reg_device_label: "ID устройства", 
        reg_city_label: "Город", 
        reg_make_label: "Марка", 
        reg_model_label: "Модель транспортного средства", 
        reg_engine_label: "Номер двигателя", 
        reg_color_label: "Цвет транспортного средства",
        regBtn: "Создать регистрацию", 
        registerSuccess: "Регистрация успешно создана!",
        quickReadBtn: "Считать все устройства",
        quickSimulateBtn: "Смоделировать все поездки",
        aqiMapTitle: "Интерактивная карта качества воздуха", 
        aqiDetailTitle: "Детали качества воздуха",
        globalAqiTitle: "Средние значения AQI по странам",
        aqiLocation: "Местоположение", 
        aqiText: "AQI", 
        aqiPollutant: "Основной загрязнитель", 
        locateBtn: "Мое местоположение", 
        aqiClear: "Очистить", 
        searchPlaceholder: "Введите подробный адрес (улица, город, страна)",
        pollutantTitle: "Детали загрязнителей (µg/m³)",
        pollutantPlaceholder: "Нажмите на карту или выполните поиск местоположения.",
        aqiNoData: "Данные AQI для этого местоположения недоступны.",
        aqiWarning_good: "✅ Качество воздуха хорошее для всех.", 
        aqiWarning_moderate: "⚠️ Умеренное. Чувствительные люди должны быть осторожны.", 
        aqiWarning_usg: "⚠️ Нездорово для чувствительных групп. Ограничьте активность на улице.", 
        aqiWarning_unhealthy: "❌ Нездорово. Избегайте физических упражнений на улице.", 
        aqiWarning_v_unhealthy: "☠️ Очень нездорово. Всем следует оставаться в помещении.", 
        aqiWarning_hazardous: "🚫 Опасно. Оставайтесь в помещении.",
        aqiMask_usg: "Рассмотрите возможность ношения маски, если у вас есть респираторные заболевания.", 
        aqiMask_unhealthy: "Надевайте маску при выходе на улицу.", 
        aqiMask_v_unhealthy: "Используйте высококачественную маску, если вам необходимо выйти.", 
        aqiMask_hazardous: "Наденьте маску и используйте очиститель воздуха.",
        noDevices: "Нет зарегистрированных устройств.",
        noVehicles: "Нет зарегистрированных транспортных средств.",
        trafficAllowed: "ДВИЖЕНИЕ РАЗРЕШЕНО",
        trafficLimited: "ОГРАНИЧЕНО (ОГРАНИЧЕННОЕ ВРЕМЯ)",
        trafficBanned: "ДВИЖЕНИЕ ЗАПРЕЩЕНО",
        rule1: "PM2.5 > 150 => Рекомендуется запрет движения.",
        rule2: "PM2.5 100-150 => Ограничено (ограниченное время).",
        rule3: "PM2.5 <= 100 => Разрешено обычное движение.",
        advice1: "Проверьте фильтры и каталитический нейтрализатор.",
        advice2: "Регулярное техническое обслуживание.",
        advice3: "Уменьшите время работы на холостом ходу.",
        loading: "Загрузка данных...",
        noHighPollution: "Области с высоким уровнем загрязнения не найдены.",
        simulationDuration: "Продолжительность симуляции: 24 секунды",
        manualRead: "Ручное считывание",
        simulateTrip: "Смоделировать поездку",
        readingAll: "Считывание всех устройств...",
        simulatingAll: "Моделирование всех поездок...",
        deleteVehicle: "Удалить",
        vehicleAdviceTitle: "Рекомендации:",
        vehicleAdviceGood: "✅ Выбросы вашего транспортного средства находятся в допустимых пределах.",
        vehicleAdviceModerate: "⚠️ Рассмотрите регулярное техническое обслуживание и проверку фильтров.",
        vehicleAdvicePoor: "❌ Обнаружены высокие выбросы. Рекомендуемые действия:",
        vehicleAdviceList1: "• Проверьте и замените воздушные фильтры",
        vehicleAdviceList2: "• Проверьте каталитический нейтрализатор",
        vehicleAdviceList3: "• Запланируйте техническое обслуживание двигателя",
        vehicleAdviceList4: "• Избегайте ненужной работы на холостом ходу",
        vehicleAdviceList5: "• Рассмотрите профессиональную проверку выбросов",
        deleteConfirm: "Вы уверены, что хотите удалить это транспортное средство?",
        healthWarningTitle: "⚠️ Медицинское предупреждение для респираторных заболеваний",
        healthWarningGood: "✅ Безопасно для людей с астмой, ХОБЛ и бронхитом",
        healthWarningModerate: "⚠️ Людям с респираторными заболеваниями следует:",
        healthWarningModerate1: "• Ограничить длительные физические нагрузки на улице",
        healthWarningModerate2: "• Держать лекарства под рукой",
        healthWarningModerate3: "• Внимательно следить за симптомами",
        healthWarningHigh: "🚫 ВЫСОКИЙ РИСК для людей с:",
        healthWarningHigh1: "• Астмой",
        healthWarningHigh2: "• ХОБЛ (Хронический бронхит/Эмфизема)",
        healthWarningHigh3: "• Бронхитом",
        healthWarningHigh4: "• Другими респираторными заболеваниями",
        healthWarningActions: "Рекомендуемые действия:",
        healthWarningAction1: "• Оставайтесь в помещении с закрытыми окнами",
        healthWarningAction2: "• Используйте очистители воздуха",
        healthWarningAction3: "• Избегайте физических нагрузок",
        healthWarningAction4: "• Держите спасательные лекарства доступными",
        healthWarningAction5: "• Проконсультируйтесь с врачом при ухудшении симптомов"
    }
};

let currentLang = localStorage.getItem('site_lang') || 'en';
let globalMap = null;
let aqiMap = null;
let aqiMarker = null;

const pages = {
    home: document.getElementById('page-home'),
    register: document.getElementById('page-register'),
    vehicle: document.getElementById('page-vehicle'),
    rules: document.getElementById('page-rules'),
    global: document.getElementById('page-global'),
    aqi: document.getElementById('page-aqi'),
    resources: document.getElementById('page-resources')
};

function initApp() {
    setupEventListeners();
    applyTranslations();
    renderRegistered();
    renderMyVehicles();
    updateHomeScreen();
    startBackgroundSimulation();
    loadCountryAQIData();
    show('home');
}

function setupEventListeners() {
    document.getElementById('nav-home').addEventListener('click', () => show('home'));
    document.getElementById('nav-register').addEventListener('click', () => show('register'));
    document.getElementById('nav-vehicle').addEventListener('click', () => show('vehicle'));
    document.getElementById('nav-rules').addEventListener('click', () => show('rules'));
    document.getElementById('nav-global').addEventListener('click', () => show('global'));
    document.getElementById('nav-aqi').addEventListener('click', () => show('aqi'));
    document.getElementById('nav-resources').addEventListener('click', () => show('resources'));

    document.querySelectorAll('.lang-btn').forEach(b => {
        b.addEventListener('click', () => setLanguage(b.dataset.lang));
    });

    document.getElementById('regBtn').addEventListener('click', registerDevice);

    document.getElementById('aqiAddressInput').addEventListener('input', debounce(handleAddressSearch, 300));
    document.getElementById('aqiLocateBtn').addEventListener('click', handleLocateMe);
    document.getElementById('aqiClearBtn').addEventListener('click', handleClearSearch);
}

function show(page) {
    Object.values(pages).forEach(p => p.style.display = 'none');
    pages[page].style.display = 'block';
    
    document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
    document.getElementById('nav-' + page).classList.add('active');
    
    setTimeout(() => {
        if (page === 'global' && !globalMap) {
            initGlobalMap();
        } else if (page === 'global' && globalMap) {
            globalMap.invalidateSize();
        }
        
        if (page === 'aqi' && !aqiMap) {
            initAqiMap();
        } else if (page === 'aqi' && aqiMap) {
            aqiMap.invalidateSize();
        }
        
        if (page === 'home') {
            updateHomeScreen();
        }
    }, 100);
}

function setLanguage(lang) {
    currentLang = lang;
    localStorage.setItem('site_lang', lang);
    document.querySelectorAll('.lang-btn').forEach(b => {
        b.classList.toggle('active', b.dataset.lang === lang);
    });
    applyTranslations();
    updateHomeScreen();
    loadCountryAQIData();
}

function applyTranslations() {
    const t = translations[currentLang] || translations.en;
    
    document.title = t.title;
    document.getElementById('nav-home').textContent = t.nav.home;
    document.getElementById('nav-register').textContent = t.nav.register;
    document.getElementById('nav-vehicle').textContent = t.nav.vehicle;
    document.getElementById('nav-rules').textContent = t.nav.rules;
    document.getElementById('nav-global').textContent = t.nav.global;
    document.getElementById('nav-aqi').textContent = t.nav.aqi;
    document.getElementById('nav-resources').textContent = t.nav.resources;
    
    document.getElementById('home-title').textContent = t.homeTitle;
    document.getElementById('home-desc').textContent = t.homeDesc;
    document.getElementById('lastReadLabel').textContent = t.lastReadLabel;
    document.getElementById('vehicleStatusLabel').textContent = t.vehicleStatusLabel;
    document.getElementById('behaviourLabel').textContent = t.behaviourLabel;
    document.getElementById('behaviourText').textContent = t.behaviourText;
    document.getElementById('quickRegisterTitle').textContent = t.quickRegisterTitle;
    document.getElementById('quickRegisterDesc').textContent = t.quickRegisterDesc;
    
    document.getElementById('regTitle').textContent = t.regTitle;
    document.getElementById('reg_plate_label').textContent = t.reg_plate_label;
    document.getElementById('reg_device_label').textContent = t.reg_device_label;
    document.getElementById('reg_city_label').textContent = t.reg_city_label;
    document.getElementById('reg_make_label').textContent = t.reg_make_label;
    document.getElementById('reg_model_label').textContent = t.reg_model_label;
    document.getElementById('reg_engine_label').textContent = t.reg_engine_label;
    document.getElementById('reg_color_label').textContent = t.reg_color_label;
    document.getElementById('regBtn').textContent = t.regBtn;
    document.getElementById('registeredTitle').textContent = t.registeredTitle;
    document.getElementById('myVehiclesTitle').textContent = t.myVehiclesTitle;
    document.getElementById('rulesTitle').textContent = t.rulesTitle;
    document.getElementById('globalTitle').textContent = t.globalTitle;
    document.getElementById('globalDesc').textContent = t.globalDesc;
    document.getElementById('resourcesTitle').textContent = t.resourcesTitle;
    document.getElementById('resourcesDesc').textContent = t.resourcesDesc;

    document.getElementById('aqiMapTitle').textContent = t.aqiMapTitle;
    document.getElementById('aqiDetailTitle').textContent = t.aqiDetailTitle;
    document.getElementById('globalAqiTitle').textContent = t.globalAqiTitle;
    document.getElementById('aqiLocateBtn').textContent = t.locateBtn;
    document.getElementById('aqiClearBtn').textContent = t.aqiClear;
    document.getElementById('pollutantTitle').textContent = t.pollutantTitle;
    document.getElementById('pollutantsPlaceholder').textContent = t.pollutantPlaceholder;
    document.getElementById('aqiAddressInput').placeholder = t.searchPlaceholder;
    document.getElementById('quickReadBtn').textContent = t.quickReadBtn;
    document.getElementById('quickSimulateBtn').textContent = t.quickSimulateBtn;

    document.getElementById('rule1').textContent = t.rule1;
    document.getElementById('rule2').textContent = t.rule2;
    document.getElementById('rule3').textContent = t.rule3;
    document.getElementById('adviceTitle').textContent = t.rulesTitle.replace('Rules & ', '');
    document.getElementById('advice1').textContent = t.advice1;
    document.getElementById('advice2').textContent = t.advice2;
    document.getElementById('advice3').textContent = t.advice3;

    renderRegistered();
    renderMyVehicles();
}

// ... (kalan kod aynı, sadece resources sayfası eklendi)

// Kalan tüm fonksiyonlar aynı kalacak, sadece resources sayfası eklendi
// Burada sadece değişiklik yapılan kısımları gösterdim, geri kalan kod aynı

document.addEventListener('DOMContentLoaded', initApp);
</script>
</body>
</html>
